var table;$(document).ready(function(){table=$("#table-product").DataTable({ajax:{url:"../admin/products/show",dataSrc:"results",dataType:"json",type:"GET"},responsive:!0,bInfo:!1,lengthMenu:[[5,10,25],[5,10,25]],lengthChange:!0,bProcessing:!0,retrieve:!0,language:{processing:"Sedang memuat data..",decimal:",",thousands:"."},columns:[{data:null,sortable:!1,render:function(a,b,c,d){return d.row+1}},{data:"sku"},{data:"name"},{data:"category_name"},{data:"harga",render:$.fn.dataTable.render.number(",",".",2,"Rp ")},{data:"stok"},{data:"product_status",mRender:function(a){return"ACTIVE"==a?`<a class='btn btn-info'><i class="fas fa-check-circle mr-2"></i>`+a+`</a>`:`<a class='btn btn-danger'><i class="fas fa-times-circle mr-2"></i>`+a+`</a>`}},{data:"product_id",render:function(a){return`<a data-toggle="modal" onclick="submit(`+a+`)" class="btn btn-success" data-target="#myModal" ><i class="fas fa-edit"></i>Edit</a> <a class="btn btn-danger" onclick="deleteData(`+a+`)"><i class="fas fa-trash-alt"></i>Hapus</a>`}}]})});function submit(a){$("#product_id").val(""),$("#sku").val(""),$("#name").val(""),$("#category_id").val(""),$("#category_id").empty(),$("#harga").val(""),$("#stok").val(""),$("#status").val(""),"tambah"==a?($("#myModalTitle").text("Tambah Data"),$("#btn-tambah").show(),$("#btn-ubah").hide(),$.ajax({url:"../admin/categories/active",type:"get",dataType:"json",success:function(a){$.each(a.results,function(a,b){$("#category_id").append(`
                        <option value='`+b.category_id+`'>`+b.category_name+`</option>
                    `)})}})):($("#myModalTitle").text("Ubah Data"),$("#btn-tambah").hide(),$("#btn-ubah").show(),$.ajax({url:"../admin/products/"+a,type:"get",dataType:"json",success:function(a){$.each(a.category,function(a,b){$("#category_id").append(`
                            <option value='`+b.category_id+`'>`+b.category_name+`</option>
                            `)}),$.each(a.product,function(a,b){$("#product_id").val(b.product_id),$("#sku").val(b.sku),$("#name").val(b.name),$("#category_id").val(b.category_id),$("#harga").val(b.harga),$("#stok").val(b.stok),$("#status").val(b.product_status)})},error:function(a){console.log(a)}}))}function updateData(){var a=$("#product_id").val(),b=$("#sku").val(),c=$("#name").val(),d=$("#category_id").val(),e=$("#harga").val(),f=$("#stok").val(),g=$("#status").val();$.ajax({url:"../admin/products/update/"+a,type:"post",data:"sku="+b+"&name="+c+"&category_id="+d+"&harga="+e+"&stok="+f+"&status="+g,dataType:"json",success:function(){$("#myModal").modal("hide"),table.ajax.reload(),Swal.fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,icon:"success",title:"Update Data Successfully"})},error:function(a){console.log(a)}})}function tambahData(){var a=$("#sku").val(),b=$("#name").val(),c=$("#category_id").val(),d=$("#harga").val(),e=$("#stok").val(),f=$("#status").val();$.ajax({url:"../admin/products/add",type:"post",data:"sku="+a+"&name="+b+"&category_id="+c+"&harga="+d+"&stok="+e+"&status="+f,dataType:"json",success:function(a){200==a.status&&(table.ajax.reload(),$("#myModal").modal("hide"),Swal.fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,icon:"success",title:"Data Inserted Successfully"}))}})}function deleteData(a){Swal.fire({title:"Apakah anda yakin?",icon:"warning",showCancelButton:!0,confirmButtonText:`Iya, Hapus saja!`,cancelButtonText:`Tidak, Batal!`,customClass:{confirmButton:"btn btn-danger mr-3",cancelButton:"btn btn-primary"},buttonsStyling:!1}).then(b=>{b.isConfirmed?$.ajax({url:"../admin/products/"+a,type:"delete",error:function(a){Swal.fire({title:"Someting is wrong",icon:"warning",text:a})},success:function(){table.ajax.reload(),Swal.fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,icon:"success",title:"Data Deleted Successfully"})}}):Swal.fire({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,icon:"info",title:"Change are not save!",text:"Your data is saved!"})})}